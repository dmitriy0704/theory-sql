# РЕЛЯЦИОННЫЕ БАЗЫ ДАННЫХ

База данных - совокупность взаимосвязанных данных, организованных в соответствии
со схемой базы данных таким образом, чтобы с ними мог работать пользователь.

## Реляционная модель

_**Основные понятия:**_

- тип данных;
- домен - столбцы:
- атрибут - заголовок столбца;
- кортеж - строки таблицы;
- первичный ключ - id;
- отношение - таблица.

## Тип данных. Домен

Обычно в современных реляционных базах данных допускается хранение символьных
данных с фиксированной или переменной длиной, числовых данных, включая целые
числа различного размера, вещественные числа с плавающей или фиксированной
точностью, битовые данные, «темпоральные» данных (такие, как дата, время или
временной интервал).

Кроме того, многие СУБД поддерживают хранение
пространственных и слабоструктурированных данных в формате XML или JSON.
Достаточно активно развивается подход к расширению возможностей реляционных
систем абстрактными типами данных. Например, в базе данных PostgreSQL
поддерживается хранение данных специального типа «деньги».

Типизация хранимых значений не просто указывает на размерность в байтах, которую
должна выделить система для размещения в памяти того или иного значения.
Типизация также определяет, какие операции могут быть осуществлены с теми или
иными данными.

Таким образом, понятие тип данных интегрирует в себе три компоненты:

- ограничение множества принадлежащих типу значений;
- определение применяемых к типу набора операций;
- определение способа отображения значений типа.

**_Домен_**

В самом общем виде домен определяется заданием некоторого базового типа данных,
к которому относятся элементы домена, и произвольного логического выражения,
применяемого к элементу типа данных. Если вычисление этого логического выражения
дает результат «истина>>, то элемент данных является элементом домена. Домен не
подменяет понятие типизации, а выступает в качестве дополнительного ограничителя
обрабатываемой в базе данных информации.

Наиболее правильной интуитивной трактовкой понятия домена является понимание
домена как допустимого потенциального **_множества значений данного типа_**.
Например, домен «Имена» в примере с сотрудниками определен на базовом типе
строк символов, но в число его значений могут входить только те строки, которые
могут изображать имя (в частности, такие строки не могут начинаться с мягкого
знака).

## Отношение

Отношение R состоит из _**схемы**_ и _**тела**_.

**Схема**(заголовок таблицы) отношения состоит из имени атрибута и имени домена.
По определению требуется, чтобы все имена атрибутов в заголовке отношения были
различными (уникальными).

**Тело отношения** - множество кортежей(строки).
**Кортеж** - множество упорядоченных пар имени атрибута и допустимого
значения домена.

Количество кортежей называют кардинальным **числом отношения (кардинальностью)
**,
или **мощностью отношения**. Количество атрибутов называют **степенью**, или
**«арностью» отношения**.

Упрощенным представлением отношения является _таблица_, заголовком которой
является _схема отношения_, а строками - _кортежи отношения-экземпляра_; в этом
случае _имена атрибутов_ именуют столбцы этой таблицы. Поэтому иногда говорят
«столбец таблицы», имея в виду «атрибут отношения».

![t1i1.png](/imgs/t1i1.png)

Таблица (или отношение) с 6 столбцами-атрибутами (идентификатор, фамилия, имя,
зарплата, дата рождения и отдел). Кортеж определяется как множество пар вида
(имя атрибута, значение домена). Кортеж содержит 6 атрибутов, т.е. арность
отношения равна 6. Таблица содержит 5 строк, т.е. в данном случае мощность
отношения равна 5.

### Фундаментальные свойства отношений

- Отсутствие кортежей-дубликатов.
- Отсутствие упорядоченности кортежей.
- Отсутствие упорядоченности атрибутов.
- Атомарность значений атрибутов. Атомарность означает, что на пересечении
  строки и столбца должно находиться единственное значение. Примером нарушения
  атомарности может стать попытка записи в одну ячейку таблицы группы значений,
  например списка. Подобный подход также затрудняет процесс поиска и обработки
  информации. Принято говорить, что в реляционных базах данных допускаются
  только нормализованные отношения или отношения, представленные в первой
  нормальной форме.
- Целостность данных - соответствие значений всех данных в базе определенному
  непротиворечивому набору правил. Можно выделить три базовых класса правил,
  призванных поддерживать целостность данных в реляционной базе данных:
    - целостность доменов - Целостность доменов поддерживается за счет механизма
      доменных ограничений. Это как раз тот случай, когда описание домена
      включает в себя некоторые логические правила, запрещающие вносить
      некорректные значения в атрибуты таблицы. В простейшем случае допустимые
      значения могут быть просто перечислены или объявлен диапазон допустимых
      значений.
    - целостность сущностей - Одним из фундаментальных свойств отношений
      является отсутствие кортежей-дубликатов. На самом деле, свойством
      уникальности в пределах отношения могут обладать отдельные атрибуты
      кортежей или группы атрибутов. Такие уникальные атрибуты удобно
      использовать для идентификации кортежей.
    - ссылочная целостность - Связи между кортежами отношений ->

### Связи между кортежами отношений

Реляционная модель призвана не только описать перечень типов сущностей, но и
отразить особенности взаимодействия между ними. Помимо первичных ключей, в
таблицах активно применяется еще одна разновидность ключевого поля - это
**внешний ключ**. Внешние ключи предназначены для реализации связи между
кортежами отношений. Внешние ключи являются по существу, ссылками на атрибуты
связываемых кортежей. Различают три типа связи между сущностями: «один к
одному», «один ко многим» и «многие ко многим».

При выделении связи выделяют главную или родительскую
таблицу и зависимую, или дочернюю таблицу.

#### Один к одному

Связь «один к одному» встречает не часто. В этом случае объекту одной
сущности можно сопоставить только один объект другой сущности. Например, пусть
некоторым сотрудникам выданы служебные автомобили. Тогда внешний ключ «саг_id»
в таблице сотрудников будет ссылаться на одноименный первичный ключ в таблице
автомобилей.

#### Один ко многим

На практике наиболее распространена связь «один ко многим». В этом типе связей
несколько строк из дочерний таблицы зависят от одной строки в родительской
таблице. Примером такой связи может являться связь «отделы-сотрудники»: в одном
отделе работают много сотрудников, при этом сотрудник может работать только в
одном отделе. В дочерней таблице «Сотрудники» существует внешний ключ
«department_id», который устанавливает связи между таблицами сотрудников и
отделов. Если необходимо, например, найти сотрудников отдела кадров, можно
узнать ключ этого отдела в родительской таблице «Отделы». И далее найти
сотрудников, для которых значения соответствующего атрибута «department_id»
равны найденному значению ключа. Таким образом, в нашем примере в отделе кадров
работают три сотрудника, т.е. используется связь «один ко многим».

#### Многие ко многим

При типе связей «многие ко многим» одна строка из таблицы А может быть связана
с множеством строк из таблицы В. В свою очередь одна строка из таблицы В может
быть связана с множеством строк из таблицы А.
Для иллюстрация этого типа связей воспользуемся примером, связь «фильмы-актеры»:
в одном фильме снималось много актеров, один актер снимался во многих фильмах.
Для описания этих связей используется дополнительная таблица «film_actor».
Иногда данные из этой промежуточной таблицы также могут представлять собой
отдельную сущность. Используя ссылки, заданные внешними ключами, можно получить
список актеров, играющих в определенном фильме. Технически, связь многие ко
многим выполнена через две связи один-ко-многим.

## Реляционная алгебра

Реляционная алгебра представляет собой теоретический язык
операций, которые на основе одного или нескольких отношений
позволяют создавать другое отношение.
Операции реляционной алгебры:

1) выборка (selection) CJ;
2) проекция (projection) П;
3) декартово произведение (cartesian product) х ;
4) объединение, сложение (union) U;
5) вычитание, разность (set difference) -;
6) пересечение (intersection) n;
7) деление (division) \;
8) соединение (Goin) ||

Реляционная алгебра базируется на традиционных теоретикомножественных операциях
(это пересечение, объединение, вычитание и декартово произведение), которые
дополнены четырьмя операциями, специфичными для обработки реляционных данных
(выборка, проекция, деление и соединение). Все эти операции обрабатывают
отношения, которые (по определению) являются множествами кортежей. Кроме этих
операций, в реляционную алгебру включают операцию переименования атрибутов (AS),
позволяющую корректно формировать схему результирующего отношения, и операцию
присваивания(=), позволяющую сохранять в базе данных результаты вычисления
алгебраических выражений.
